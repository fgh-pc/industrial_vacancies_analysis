import requests
import json

def test_hh_api():
    """–ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç API HH.ru"""
    url = "https://api.hh.ru/vacancies"
    params = {
        "text": "–ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å",
        "area": 113,  # –†–æ—Å—Å–∏—è
        "per_page": 10,
        "page": 0
    }
    
    try:
        response = requests.get(url, params=params)
        response.raise_for_status()  # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—à–∏–±–∫–∏ HTTP
        
        data = response.json()
        
        print("‚úÖ API —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!")
        print(f"üìä –ù–∞–π–¥–µ–Ω–æ –≤–∞–∫–∞–Ω—Å–∏–π: {data['found']}")
        print(f"üìÑ –°—Ç—Ä–∞–Ω–∏—Ü: {data['pages']}")
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö
        with open("data/raw/sample_data.json", "w", encoding="utf-8") as f:
            json.dump(data, f, ensure_ascii=False, indent=2)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—É—é –≤–∞–∫–∞–Ω—Å–∏—é
        if data["items"]:
            first_vacancy = data["items"][0]
            print("\nüìã –ü—Ä–∏–º–µ—Ä –≤–∞–∫–∞–Ω—Å–∏–∏:")
            print(f"–ù–∞–∑–≤–∞–Ω–∏–µ: {first_vacancy.get('name')}")
            print(f"–ó–∞—Ä–ø–ª–∞—Ç–∞: {first_vacancy.get('salary')}")
            print(f"–†–µ–≥–∏–æ–Ω: {first_vacancy.get('area', {}).get('name')}")
            print(f"–û–ø—ã—Ç: {first_vacancy.get('experience', {}).get('name')}")
            
        return True
        
    except requests.exceptions.RequestException as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ: {e}")
        return False

if __name__ == "__main__":
    test_hh_api()